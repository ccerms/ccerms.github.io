import{at as Y,au as N,aq as O,r as y,ap as W,c as S,o as i,a as h,b as a,w as r,f as n,j as t,v as B,F as A,d as j,t as k,Q as J,l as H,i as I,ar as K,e as F,g as G,_ as Z,m as ee,k as te,n as le,q as se,S as ae,p as ue,z as oe,W as ne,as as de}from"./index.cf42fdb7.js";import{_ as M}from"./CardBoxModal.293300a9.js";import{_ as re}from"./NotificationBar.92bb6639.js";import{_ as b}from"./FormField.fc61414c.js";import{_ as V}from"./FormControl.44c64591.js";import{a as R,s as X}from"./settings_data.af95b34a.js";import{u as ie}from"./users.2cbc3e24.js";import{u as pe}from"./groups.4af2f32e.js";import{u as ce}from"./scheduletype.37924cd0.js";const Q=Y("schedules",{state:()=>({list:[],request:{id:"",date:"",venue:"",from_time:"",to_time:"",scheduletype:"",grouptype:1,group:"",status:4,panels:[]},status:{status:!0,success:!1,message:""}}),actions:{fetch(){N.get(`${O}api/schedules`).then(p=>{this.list=p.data})},create(){return new Promise((p,v)=>{N.post(`${O}api/schedules`,this.request,{headers:{"Content-Type":"application/json"}}).then(d=>{this.list=d.data.schedules,this.status={status:!1,success:d.data.status==200,message:d.data.message},this.clear(),p(d)}).catch(d=>{this.status={status:!1,success:!1,message:"Server error!"},v(d)})})},select(p){this.request={id:p.id,date:p.date,venue:p.venue,from_time:p.from_time,to_time:p.to_time,scheduletype:p.scheduletype_id,grouptype:p.grouptype_id,group:p.group_id,status:p.status_id,panels:p.schedulepanels}},update(){return new Promise((p,v)=>{N.put(`${O}api/schedules/${this.request.id}`,this.request,{headers:{"Content-Type":"application/json"}}).then(d=>{this.list=d.data.schedules,this.status={status:!1,success:d.data.status==200,message:d.data.message},this.clear(),p(d)}).catch(d=>{this.status={status:!1,success:!1,message:"Server error!"},v(d)})})},destroy(){console.log(this.id)},destroy_personnel(p,v){N.delete(`${O}api/${v}/${p}`)},clear(){this.request={id:"",date:"",venue:"",from_time:"",to_time:"",scheduletype:"",grouptype:1,group:"",status:4,panels:[]}}}}),me=n("h4",{class:"text-center"}," Click Delete to remove from list... ",-1),fe={class:"space-y-3"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye=n("hr",null,null,-1),_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"flex justify-center"},ge={class:"bg-white rounded-lg w-96 text-gray-900"},be={__name:"Create",props:{teachers:{type:Array,default:[]},groups:{type:Array,default:[]},scheduleTypes:{type:Array,default:[]}},emits:["back","scheduleCreate"],setup(p,{emit:v}){const d=p,l=Q(),x=y(!1),_=y(""),q=y(""),m=y(""),T=y(!1),U=y(null),D=W("Loader");S(()=>d.teachers.map(u=>({id:u.id,label:u.fullname})));const L=S(()=>R.filter(u=>u.id<3)),C=S(()=>{var u=[];return u=d.groups.map(e=>({id:e.id,label:e.groupname,type_id:e.type_id,panel:e.panel})),u=u.filter(e=>e.type_id==1),u}),w=S(()=>{var u=[];return u=d.groups.map(e=>({id:e.id,label:e.groupname,type_id:e.type_id,panel:e.panel})),u=u.filter(e=>e.type_id==2),u}),P=S(()=>d.scheduleTypes.map(u=>({id:u.id,label:u.type}))),$=S(()=>X.filter(u=>u.id>=4&&u.id<=8)),c=()=>{v("back",!1)},o=()=>{D.show(),l.create().then(u=>{D.hide(),v("scheduleCreate",{status:!0,list:u.data.schedules})}).catch(()=>{D.hide(),v("scheduleCreate",{status:!1})})},g=()=>{if(m.value==""){alert("Fullname required");return}_.value=="member"?l.request.member.push({id:null,fullname:m.value}):_.value=="adviser"?l.request.adviser.push({id:null,fullname:m.value}):l.request.panel.push({id:null,fullname:m.value})},E=()=>{_.value=="member"?l.request.member.splice(U,1):_.value=="adviser"?l.request.adviser.splice(U,1):l.request.panel.splice(U,1)},z=u=>{const e=u==1?C.value.indexOf(C.value.find(f=>f.id==l.request.group)):C.value.indexOf(w.value.find(f=>f.id==l.request.group)),s=u==1?C.value[e].panel:w.value[e].panel;l.request.panels=s.map(f=>({id:f.user.id,fullname:`${f.user.firstname} ${f.user.middlename} ${f.user.lastname}`,is_create:!0}))};return(u,e)=>(i(),h(A,null,[a(M,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),"large-title":q.value,button:"success",buttonLabel:"Add    ",onConfirm:e[2]||(e[2]=s=>g())},{default:r(()=>[a(b,{label:"Fullname"},{default:r(()=>[a(V,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue","large-title"]),a(M,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=s=>T.value=s),"large-title":"Delete entry...",button:"warning",buttonLabel:"Delete",onConfirm:e[4]||(e[4]=s=>E())},{default:r(()=>[me]),_:1},8,["modelValue"]),a(B,{title:"Create Schedule",form:!0,headerIcon:t(K),onHeaderIconClick:e[15]||(e[15]=s=>c())},{default:r(()=>[n("div",fe,[n("div",he,[a(b,{label:"Schedule Date"},{default:r(()=>[a(V,{modelValue:t(l).request.date,"onUpdate:modelValue":e[5]||(e[5]=s=>t(l).request.date=s),type:"date"},null,8,["modelValue"])]),_:1}),a(b,{label:"Schedule Venue"},{default:r(()=>[a(V,{modelValue:t(l).request.venue,"onUpdate:modelValue":e[6]||(e[6]=s=>t(l).request.venue=s)},null,8,["modelValue"])]),_:1}),a(b,{label:"Group Type"},{default:r(()=>[a(V,{modelValue:t(l).request.grouptype,"onUpdate:modelValue":e[7]||(e[7]=s=>t(l).request.grouptype=s),options:t(L)},null,8,["modelValue","options"])]),_:1}),a(b,{label:"Group"},{default:r(()=>[a(V,{modelValue:t(l).request.group,"onUpdate:modelValue":e[8]||(e[8]=s=>t(l).request.group=s),options:t(l).request.grouptype==1||t(l).request.grouptype==""?t(C):t(w),onChange:e[9]||(e[9]=s=>z(1))},null,8,["modelValue","options"])]),_:1}),a(b,{label:"From Time"},{default:r(()=>[a(V,{modelValue:t(l).request.from_time,"onUpdate:modelValue":e[10]||(e[10]=s=>t(l).request.from_time=s),type:"time"},null,8,["modelValue"])]),_:1}),a(b,{label:"To Time"},{default:r(()=>[a(V,{modelValue:t(l).request.to_time,"onUpdate:modelValue":e[11]||(e[11]=s=>t(l).request.to_time=s),type:"time"},null,8,["modelValue"])]),_:1}),a(b,{label:"Schedule Type"},{default:r(()=>[a(V,{modelValue:t(l).request.scheduletype,"onUpdate:modelValue":e[12]||(e[12]=s=>t(l).request.scheduletype=s),options:t(P)},null,8,["modelValue","options"])]),_:1}),a(b,{label:"Status"},{default:r(()=>[a(V,{modelValue:t(l).request.status,"onUpdate:modelValue":e[13]||(e[13]=s=>t(l).request.status=s),options:t($)},null,8,["modelValue","options"])]),_:1})]),ye,n("div",_e,[n("div",null,[a(B,{title:"Panels"},{default:r(()=>[n("div",ve,[n("ul",ge,[(i(!0),h(A,null,j(t(l).request.panels,(s,f)=>(i(),h("li",{key:f,class:"px-6 py-2 border-b border-gray-200 w-full flex justify-between"},[n("p",null,k(s.fullname),1)]))),128))])])]),_:1})])])]),a(J),a(H,null,{default:r(()=>[a(I,{label:"Create",color:"info",onClick:e[14]||(e[14]=s=>o())})]),_:1})]),_:1},8,["headerIcon"])],64))}},Ve=n("h4",{class:"text-center"}," Click Delete to remove from list... ",-1),qe={class:"space-y-3"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ke=n("hr",null,null,-1),Se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce={class:"flex justify-center"},xe={class:"bg-white rounded-lg w-96 text-gray-900"},Te={__name:"Update",props:{teachers:{type:Array,default:[]},groups:{type:Array,default:[]},scheduleTypes:{type:Array,default:[]}},emits:["back","scheduleUpdate"],setup(p,{emit:v}){const d=p,l=Q(),x=y(!1),_=y(""),q=y(""),m=y(""),T=y(!1),U=y(null),D=W("Loader");S(()=>d.teachers.map(u=>({id:u.id,label:u.fullname})));const L=S(()=>R.filter(u=>u.id<3)),C=S(()=>{var u=[];return u=d.groups.map(e=>({id:e.id,label:e.groupname,type_id:e.type_id,panel:e.panel})),u=u.filter(e=>e.type_id==1),u}),w=S(()=>{var u=[];return u=d.groups.map(e=>({id:e.id,label:e.groupname,type_id:e.type_id,panel:e.panel})),u=u.filter(e=>e.type_id==2),u}),P=S(()=>d.scheduleTypes.map(u=>({id:u.id,label:u.type}))),$=S(()=>X.filter(u=>u.id>=4&&u.id<=8)),c=()=>{v("back",!1)},o=()=>{D.show(),l.update().then(u=>{D.hide(),v("scheduleUpdate",{status:!0,list:u.data.schedules})}).catch(()=>{D.hide(),v("scheduleUpdate",{status:!1})})},g=()=>{if(m.value==""){alert("Fullname required");return}_.value=="member"?l.request.member.push({id:null,fullname:m.value}):_.value=="adviser"?l.request.adviser.push({id:null,fullname:m.value}):l.request.panel.push({id:null,fullname:m.value})},E=()=>{_.value=="member"?l.request.member.splice(U,1):_.value=="adviser"?l.request.adviser.splice(U,1):l.request.panel.splice(U,1)},z=u=>{const e=u==1?C.value.indexOf(C.value.find(f=>f.id==l.request.group)):C.value.indexOf(w.value.find(f=>f.id==l.request.group)),s=u==1?C.value[e].panel:w.value[e].panel;l.request.panels=s.map(f=>({id:f.user.id,fullname:`${f.user.firstname} ${f.user.middlename} ${f.user.lastname}`,is_create:!0}))};return(u,e)=>(i(),h(A,null,[a(M,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),"large-title":q.value,button:"success",buttonLabel:"Add    ",onConfirm:e[2]||(e[2]=s=>g())},{default:r(()=>[a(b,{label:"Fullname"},{default:r(()=>[a(V,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue","large-title"]),a(M,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=s=>T.value=s),"large-title":"Delete entry...",button:"warning",buttonLabel:"Delete",onConfirm:e[4]||(e[4]=s=>E())},{default:r(()=>[Ve]),_:1},8,["modelValue"]),a(B,{title:"Create Schedule",form:!0,headerIcon:t(K),onHeaderIconClick:e[15]||(e[15]=s=>c())},{default:r(()=>[n("div",qe,[n("div",$e,[a(b,{label:"Schedule Date"},{default:r(()=>[a(V,{modelValue:t(l).request.date,"onUpdate:modelValue":e[5]||(e[5]=s=>t(l).request.date=s),type:"date"},null,8,["modelValue"])]),_:1}),a(b,{label:"Schedule Venue"},{default:r(()=>[a(V,{modelValue:t(l).request.venue,"onUpdate:modelValue":e[6]||(e[6]=s=>t(l).request.venue=s)},null,8,["modelValue"])]),_:1}),a(b,{label:"Group Type"},{default:r(()=>[a(V,{modelValue:t(l).request.grouptype,"onUpdate:modelValue":e[7]||(e[7]=s=>t(l).request.grouptype=s),options:t(L)},null,8,["modelValue","options"])]),_:1}),a(b,{label:"Group"},{default:r(()=>[a(V,{modelValue:t(l).request.group,"onUpdate:modelValue":e[8]||(e[8]=s=>t(l).request.group=s),options:t(l).request.grouptype==1||t(l).request.grouptype==""?t(C):t(w),onChange:e[9]||(e[9]=s=>z(1))},null,8,["modelValue","options"])]),_:1}),a(b,{label:"From Time"},{default:r(()=>[a(V,{modelValue:t(l).request.from_time,"onUpdate:modelValue":e[10]||(e[10]=s=>t(l).request.from_time=s),type:"time"},null,8,["modelValue"])]),_:1}),a(b,{label:"To Time"},{default:r(()=>[a(V,{modelValue:t(l).request.to_time,"onUpdate:modelValue":e[11]||(e[11]=s=>t(l).request.to_time=s),type:"time"},null,8,["modelValue"])]),_:1}),a(b,{label:"Schedule Type"},{default:r(()=>[a(V,{modelValue:t(l).request.scheduletype,"onUpdate:modelValue":e[12]||(e[12]=s=>t(l).request.scheduletype=s),options:t(P)},null,8,["modelValue","options"])]),_:1}),a(b,{label:"Status"},{default:r(()=>[a(V,{modelValue:t(l).request.status,"onUpdate:modelValue":e[13]||(e[13]=s=>t(l).request.status=s),options:t($)},null,8,["modelValue","options"])]),_:1})]),ke,n("div",Se,[n("div",null,[a(B,{title:"Panels"},{default:r(()=>[n("div",Ce,[n("ul",xe,[(i(!0),h(A,null,j(t(l).request.panels,(s,f)=>(i(),h("li",{key:f,class:"px-6 py-2 border-b border-gray-200 w-full flex justify-between"},[n("p",null,k(s.fullname),1)]))),128))])])]),_:1})])])]),a(J),a(H,null,{default:r(()=>[a(I,{label:"Update",color:"info",onClick:e[14]||(e[14]=s=>o())})]),_:1})]),_:1},8,["headerIcon"])],64))}},we={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},Ue={key:0},De=n("th",null,"Date",-1),Ae=n("th",null,"Venue",-1),Le=n("th",null,"Time Schedule",-1),Pe=n("th",null,"Group",-1),Fe=n("th",null,"Group Type",-1),je=n("th",null,"Schedule Type",-1),Ge=n("th",null,"Panels",-1),Ie=n("th",null,"Status",-1),Be=n("th",null,null,-1),Me={"data-label":"Date"},Ne={"data-label":"Venue"},Oe={"data-label":"Time Schedule"},He={"data-label":"Group"},Ee={"data-label":"Group Type"},ze={"data-label":"Schedule Type"},Qe={"data-label":"Panels"},We={"data-label":"Status"},Je={key:0,class:"p-1 bg-yellow-400 text-white text-sm rounded font-semibold"},Ke={key:1,class:"p-1 bg-lime-400 text-white text-sm rounded font-semibold"},Re={key:2,class:"p-1 bg-red-400 text-white text-sm rounded font-semibold"},Xe={key:3,class:"p-1 bg-red-400 text-white text-sm rounded font-semibold"},Ye={class:"before:hidden lg:w-1 whitespace-nowrap"},Ze={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"},et={__name:"Table",props:{data:{type:Array,default:[]},checkable:Boolean},emits:["select-section","destroy-section"],setup(p,{emit:v}){const d=p,l=S(()=>d.data);y(!1);const x=y(10),_=y(0),q=y([]),m=S(()=>l.value.slice(x.value*_.value,x.value*(_.value+1))),T=S(()=>Math.ceil(l.value.length/x.value)),U=S(()=>_.value+1),D=S(()=>{const $=[];for(let c=0;c<T.value;c++)$.push(c);return $}),L=$=>{v("select-section",$)},C=$=>{v("destroy-section",$)},w=($,c)=>{const o=[];return $.forEach(g=>{c(g)||o.push(g)}),o},P=($,c)=>{$?q.value.push(c):q.value=w(q.value,o=>o.id===c.id)};return($,c)=>(i(),h(A,null,[q.value.length?(i(),h("div",we,[(i(!0),h(A,null,j(q.value,o=>(i(),h("span",{key:o.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700"},k(o.name),1))),128))])):F("",!0),n("table",null,[n("thead",null,[n("tr",null,[d.checkable?(i(),h("th",Ue)):F("",!0),De,Ae,Le,Pe,Fe,je,Ge,Ie,Be])]),n("tbody",null,[(i(!0),h(A,null,j(t(m),o=>(i(),h("tr",{key:o.id},[d.checkable?(i(),G(Z,{key:0,onChecked:g=>P(g,o)},null,8,["onChecked"])):F("",!0),n("td",Me,k(o.date),1),n("td",Ne,k(o.venue),1),n("td",Oe,k(`${o.from_time} - ${o.to_time}`),1),n("td",He,k(o.group.groupname),1),n("td",Ee,k(o.grouptype.type),1),n("td",ze,k(o.scheduletype.type),1),n("td",Qe,[(i(!0),h(A,null,j(o.schedulepanels,g=>(i(),h("span",{key:g.id,class:"bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800"},k(g.fullname),1))),128))]),n("td",We,[o.status_id==4?(i(),h("span",Je,k(o.status.status),1)):o.status_id==5?(i(),h("span",Ke,k(o.status.status),1)):o.status_id==6||o.status_id==7?(i(),h("span",Re,k(o.status.status),1)):(i(),h("span",Xe,k(o.status.status),1))]),n("td",Ye,[a(H,{type:"justify-start lg:justify-end","no-wrap":""},{default:r(()=>[a(I,{color:"info",icon:t(ee),small:"",onClick:g=>L(o)},null,8,["icon","onClick"]),a(I,{color:"danger",icon:t(te),small:"",onClick:g=>C(o)},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])]),n("div",Ze,[a(le,null,{default:r(()=>[a(H,null,{default:r(()=>[(i(!0),h(A,null,j(t(D),o=>(i(),G(I,{key:o,active:o===_.value,label:o+1,small:"",onClick:g=>_.value=o},null,8,["active","label","onClick"]))),128))]),_:1}),n("small",null,"Page "+k(t(U))+" of "+k(t(T)),1)]),_:1})])],64))}},it={__name:"Schedules",setup(p){const v=y(["Admin","Events","Defense Schedules"]),d=Q(),l=ie(),x=pe(),_=ce(),q=y(!1),m=y(!1);y(!1);const T=y(!1),U=()=>{d.status.status=!0};d.fetch(),l.fetchAvailable(),x.fetch(),_.fetch();const D=()=>{q.value=!0,m.value=!1,d.clear()},L=c=>{c.status&&(d.list=c.list,q.value=!1,m.value=!1)},C=c=>{c.status&&(d.list=c.list,q.value=!1,m.value=!1)},w=()=>{q.value=!1,m.value=!1},P=c=>{m.value=!0,q.value=!1,d.select(c)},$=c=>{T.value=!0,d.select(c)};return(c,o)=>(i(),h(A,null,[a(M,{modelValue:T.value,"onUpdate:modelValue":o[0]||(o[0]=g=>T.value=g),"large-title":"Delete Milestone",button:"danger",buttonLabel:"Confirm",onConfirm:o[1]||(o[1]=g=>c.milestoneStore.destroy()),"has-cancel":""},null,8,["modelValue"]),a(se,{"title-stack":v.value},null,8,["title-stack"]),a(ae,null,{default:r(()=>[t(d).status.status?F("",!0):(i(),G(re,{key:0,isDismissed:t(d).status.status,color:t(d).status.success?"success":"danger",icon:t(oe),onHideNotification:U},{default:r(()=>[ue(k(t(d).status.message),1)]),_:1},8,["isDismissed","color","icon"])),q.value?(i(),G(be,{key:1,teachers:t(l).subjectteacher_available,groups:t(x).list,scheduleTypes:t(_).list,onBack:w,onScheduleCreate:L},null,8,["teachers","groups","scheduleTypes"])):F("",!0),m.value?(i(),G(Te,{key:2,groups:t(x).list,scheduleTypes:t(_).list,onBack:w,onScheduleUpdate:C},null,8,["groups","scheduleTypes"])):F("",!0),!q.value&&!m.value?(i(),G(B,{key:3,title:"Schedules List",hasTable:!0,icon:t(ne),headerIcon:t(de),onHeaderIconClick:o[2]||(o[2]=g=>D())},{default:r(()=>[a(et,{data:t(d).list,onSelectSection:P,onDestroySection:$},null,8,["data"])]),_:1},8,["icon","headerIcon"])):F("",!0)]),_:1})],64))}};export{it as default};
